(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};function t(e){var t="https://nomoreparties.co/v1/".concat("wff-cohort-3","/cards/").concat(e);fetch(t,{method:"DELETE",headers:{authorization:"1eebc460-8f14-44d3-8f3a-287aa4f24719"}}).then((function(e){if(!e.ok)throw new Error("Ошибка: ".concat(e.status));return e.json()})).then((function(e){console.log("Карточка удалена:",e)})).catch((function(e){return console.error(e)}))}function n(e,t){var n=e.classList.contains("card__like-button_is-active"),o=n?"DELETE":"PUT",r="https://nomoreparties.co/v1/".concat("wff-cohort-3","/cards/likes/").concat(t);fetch(r,{method:o,headers:{authorization:"1eebc460-8f14-44d3-8f3a-287aa4f24719"}}).then((function(e){if(!e.ok)throw new Error("Ошибка: ".concat(e.status));return e.json()})).then((function(t){var o=t.likes.length;!function(e,t,n){e.classList.toggle("card__like-button_is-active",!t),e.closest(".places__item").querySelector(".card__like-count").textContent=n}(e,n,o)})).catch((function(e){return console.error(e)}))}function o(e){if("Escape"===e.key){var t=document.querySelector(".popup_is-opened");t&&c(t)}}function r(e){e.classList.add("popup_is-animated"),setTimeout((function(){e.classList.add("popup_is-opened")}),1),e.addEventListener("click",a),document.addEventListener("keydown",o)}function c(e){e.classList.remove("popup_is-opened"),e.classList.add("popup_is-animated"),document.removeEventListener("keydown",o),e.removeEventListener("click",a)}function a(e){var t=e.currentTarget;e.target===t&&c(t)}e.d({},{Y:()=>G});var u=function(e,t){e.some((function(e){return!e.validity.valid}))?t.classList.add("button_inactive"):t.classList.remove("button_inactive")},i=function(e,t,n){var o=e.querySelector(".".concat(t.name,"-error"));t.classList.add("popup__input_type_error"),o.textContent=n||t.validationMessage,o.classList.add("popup__input-error_active")},l=function(e,t){var n=e.querySelector(".".concat(t.name,"-error"));t.classList.remove("popup__input_type_error"),n.classList.remove("popup__input-error_active"),n.textContent=""},p=function(){Array.from(document.querySelectorAll(".popup")).forEach((function(e){e.addEventListener("submit",(function(e){e.preventDefault()})),Array.from(e.querySelectorAll(".popup__content")).forEach((function(e){!function(e){var t=Array.from(e.querySelectorAll(".popup__input")),n=e.querySelector(".popup__button");n&&(u(t,n),t.forEach((function(o){o.addEventListener("input",(function(){!function(e,t){if(t.validity.valid)l(e,t);else{var n=t.dataset.customError;n&&t.validity.patternMismatch?i(e,t,n):i(e,t)}}(e,o),u(t,n)}))})))}(e)}))}))},s=function(e){var t=Array.from(e.querySelectorAll(".popup__input")),n=e.querySelector(".popup__button");t.forEach((function(t){l(e,t)})),u(t,n)},d="1eebc460-8f14-44d3-8f3a-287aa4f24719",f="wff-cohort-3",_=("https://nomoreparties.co/v1/".concat(f,"/users/me"),"https://nomoreparties.co/v1/".concat(f,"/cards")),m=function(e,t){return fetch(e,{headers:{authorization:"".concat(t)}}).then((function(e){if(!e.ok)throw new Error("Error: ".concat(e.status));return e.json()})).catch((function(e){return console.error(e)}))};function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}document.querySelector(".places__list");var v=document.querySelector(".popup_type_edit"),h=document.querySelector(".popup_type_new-card"),S=document.querySelector(".popup_type_image"),q=document.querySelector(".profile__edit-button"),b=document.querySelector(".profile__add-button"),k=v.querySelector(".popup__close"),E=h.querySelector(".popup__close"),L=S.querySelector(".popup__close"),g=document.forms["edit-profile"],w=g.querySelector(".popup__input_type_name"),C=g.querySelector(".popup__input_type_description"),x=document.forms["new-place"],j=x.querySelector(".popup__input_type_card-name"),A=x.querySelector(".popup__input_type_url"),T=document.querySelector(".profile__title"),O=document.querySelector(".profile__description"),P=S.querySelector(".popup__image"),D=S.querySelector(".popup__caption"),I=document.querySelector(".profile__image"),z=document.querySelector(".popup_type_avatar-edit"),N=document.forms["avatar-edit"],J=N.querySelector(".popup__input_type_avatar-url"),M=z.querySelector(".popup__close");function U(e,t){P.src=e,P.alt=t,D.textContent=t,r(S)}k.addEventListener("click",(function(){return c(v)})),E.addEventListener("click",(function(){return c(h)})),L.addEventListener("click",(function(){return c(S)})),q.addEventListener("click",(function(){r(v),s(g);var e=T.textContent,t=O.textContent;w.value=e,C.value=t})),b.addEventListener("click",(function(){return r(h)})),g.addEventListener("submit",(function(e){e.preventDefault();var t,n,o,r=w.value,a=C.value;g.querySelector(".popup__button").textContent="Сохранение...",T.textContent=r,O.textContent=a,c(v),t=r,n=a,o="https://nomoreparties.co/v1/".concat(f,"/users/me"),fetch(o,{method:"PATCH",headers:{authorization:d,"Content-Type":"application/json"},body:JSON.stringify({name:t,about:n})}).then((function(e){if(!e.ok)throw new Error("Ошибка: ".concat(e.status));return e.json()})).then((function(e){updateUserInfo(e)})).catch((function(e){return console.error("Ошибка при обновлении профиля:",e)}))})),p();var H="1eebc460-8f14-44d3-8f3a-287aa4f24719",Y="wff-cohort-3",$="https://nomoreparties.co/v1/".concat(Y,"/users/me"),B="https://nomoreparties.co/v1/".concat(Y,"/cards");Promise.all([m($,H),m(B,H)]).then((function(e){var t,n,o=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,c,a,u=[],i=!0,l=!1;try{if(c=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;i=!1}else for(;!(i=(o=c.call(n)).done)&&(u.push(o.value),u.length!==t);i=!0);}catch(e){l=!0,r=e}finally{try{if(!i&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw r}}return u}}(t,n)||function(e,t){if(e){if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),r=o[0],c=o[1];F(r),G(c),console.log(r,c)}));var F=function(e){var t=document.querySelector(".profile__image");T.textContent=e.name,O.textContent=e.about,t.style.backgroundImage="url('".concat(e.avatar,"')")},G=function(e){var o=document.querySelector(".places__list");e.forEach((function(e){var r=function(e,t,n){var o=t.deleteCard,r=t.addLike,c=t.openImagePopup,a=document.querySelector("#card-template").content.querySelector(".places__item").cloneNode(!0),u=a.querySelector(".card__image"),i=a.querySelector(".card__like-button"),l=a.querySelector(".card__delete-button");u.src=e.link,u.alt=e.name,u.addEventListener("click",(function(){return c(e.link,e.name)})),a.querySelector(".card__title").textContent=e.name,e.owner&&"9623ac04fd0dea80401d1a0a"===e.owner._id?l.style.display="block":l.style.display="none",l.addEventListener("click",(function(){e._id?(o(e._id),a.remove()):console.error("Отсутствует свойство _id в объекте cardData")})),i.addEventListener("click",(function(){e._id?r(i,e._id):console.error("Отсутствует свойство _id в объекте cardData")}));var p=e.likes?e.likes.length:0;return a.querySelector(".card__like-count").textContent=p,a}(e,{deleteCard:t,addLike:n,openImagePopup:U});!function(e,t){t.append(e)}(r,o)}))};m($,H).then((function(e){F(e)})),m(B,H).then((function(e){G(e)})),M.addEventListener("click",(function(){return c(z)})),I.addEventListener("click",(function(){return r(z)})),N.addEventListener("submit",(function(e){e.preventDefault();var t=J.value;N.querySelector(".popup__button").textContent="Сохранение...",function(e){var t=document.querySelector(".profile__image"),n="https://nomoreparties.co/v1/".concat(f,"/users/me/avatar");fetch(n,{method:"PATCH",headers:{authorization:d,"Content-Type":"application/json"},body:JSON.stringify({avatar:e})}).then((function(e){if(!e.ok)throw new Error("Ошибка: ".concat(e.status));return e.json()})).then((function(e){t.style.backgroundImage="url('".concat(e.avatar,"')")})).catch((function(e){return console.error(e)}))}(t),c(z)})),p(),x.addEventListener("submit",(function(e){e.preventDefault();var t=j.value,n=A.value;x.querySelector(".popup__button").textContent="Сохранение...",function(e){var t=e.name,n=e.link,o=document.querySelector(".popup_type_new-card"),r=document.forms["new-place"],a=r.querySelector(".popup__button"),u="https://nomoreparties.co/v1/".concat(f,"/cards");fetch(u,{method:"POST",headers:{authorization:d,"Content-Type":"application/json"},body:JSON.stringify({name:t,link:n})}).then((function(e){if(!e.ok)throw new Error("Ошибка: ".concat(e.status));return e.json()})).then((function(e){console.log("Новая карточка добавлена:",e),m(_,d).then((function(e){!function(){for(var e=document.querySelector(".places__list");e.firstChild;)e.removeChild(e.firstChild)}(),G(e)})),a.textContent="Сохранить",c(o),r.reset(),s(r)})).catch((function(e){console.error(e),a.textContent="Сохранить"}))}({name:t,link:n})}))})();